<ion-header>

  <ion-navbar>

    <ion-grid no-padding>
      <ion-row align-items-center>
        <ion-col text-left col-2>
          <button no-padding text-capitalize ion-button clear color="clear" (click)="dismiss()" icon-left><ion-icon name="ios-arrow-back"></ion-icon>Cancel</button>
        </ion-col>
        <ion-col text-center col-8>
          <ion-title><b>Search & Filters</b></ion-title>
        </ion-col>
        <ion-col text-right col-2 *ngIf="extended">
          <button no-padding text-capitalize clear color="clear" ion-button (click)="clearSearchParams()">Clear all</button>
        </ion-col>
      </ion-row>
    </ion-grid>

  </ion-navbar>

</ion-header>


<ion-content no-padding>

  <ion-grid padding>
    <ion-row>
      <ion-col text-right>
        <button small ion-button text-capitalize color="activated" (click)="switchType()">{{extended ? 'Order ID' : 'Detailed search'}}</button>
      </ion-col>
    </ion-row>
  </ion-grid>

  <section padding *ngIf="!extended">

    <form [formGroup]="searchForm">

      <ion-list>
        <ion-item no-margin no-padding>
          <ion-input formControlName="purchase_id" type="text" placeholder="Order ID"></ion-input>
        </ion-item>
        <ion-label *ngIf="showedError" class="err-message" no-margin>
          {{ showedError }}
        </ion-label>
      </ion-list>

    </form>

  </section>

  <section *ngIf="extended" no-padding>

    <ion-list no-padding>

        <ion-item-divider style="min-height: 0"><ion-label no-margin></ion-label></ion-item-divider>
        <button no-padding ion-item icon-end (click)="setActive('product')">
          <ion-icon [color]="activeTab === 'product' ? 'primary' : 'dark'" name="{{activeTab === 'product' ? 'ios-arrow-up' :'ios-arrow-down'}}" item-end></ion-icon>
          <ion-label padding-left [color]="activeTab === 'product' ? 'primary' : 'dark'">Product Name</ion-label>
        </button>

        <form [formGroup]="searchFormExtended">

          <ion-list padding *ngIf="activeTab === 'product'">
            <ion-item no-margin no-padding>
              <ion-input formControlName="purchase_id" type="text" placeholder="Order ID"></ion-input>
            </ion-item>

            <ion-item no-margin no-padding hidden>
              <ion-input formControlName="product_id" type="text" placeholder="Product ID"></ion-input>
            </ion-item>

            <ion-auto-complete [dataProvider]="complServ" #searchbar (itemSelected)="selectedProduct($event)" [options]="{ placeholder : 'Product name' }"></ion-auto-complete>
          </ion-list>

          <button no-padding ion-item icon-end (click)="setActive('customer')">
            <ion-icon [color]="activeTab === 'customer' ? 'primary' : 'dark'" name="{{activeTab === 'customer' ? 'ios-arrow-up' :'ios-arrow-down'}}" item-end></ion-icon>
            <ion-label padding-left [color]="activeTab === 'customer' ? 'primary' : 'dark'">Customer Info</ion-label>
          </button>
          <ion-list *ngIf="activeTab === 'customer'">
            <ion-grid padding>
              <ion-row>
                <ion-col col-6>
                  <ion-item no-margin no-padding>
                    <ion-input formControlName="first_name" type="text" placeholder="First name"></ion-input>
                  </ion-item>
                </ion-col>
                <ion-col col-6>
                  <ion-item no-margin no-padding>
                    <ion-input formControlName="last_name" type="text" placeholder="Last name"></ion-input>
                  </ion-item>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col col-12>
                  <ion-item no-margin no-padding>
                    <ion-input formControlName="email" type="email" placeholder="Email"></ion-input>
                  </ion-item>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-list>

        </form>

        <button no-padding ion-item icon-end (click)="setActive('transaction')">
          <ion-icon [color]="activeTab === 'transaction' ? 'primary' : 'dark'" name="{{activeTab === 'transaction' ? 'ios-arrow-up' :'ios-arrow-down'}}" item-end></ion-icon>
          <ion-label padding-left [color]="activeTab === 'transaction' ? 'primary' : 'dark'">Transaction Details</ion-label>
        </button>
        <ion-list *ngIf="activeTab === 'transaction'">
          <ion-grid padding>
            <ion-row>
              <ion-col col-6>
                <ion-item no-margin no-padding>
                  <ion-datetime placeholder="Start day" displayFormat="YYYY-MM-DD" pickerFormat="YYYY MM DD" [(ngModel)]="searchObj.from"></ion-datetime>
                  <!--<ion-input formControlName="from" type="text" placeholder="Start day"></ion-input>-->
                </ion-item>
              </ion-col>
              <ion-col col-6>
                <ion-item no-margin no-padding>
                  <ion-datetime placeholder="End day" displayFormat="YYYY-MM-DD" pickerFormat="YYYY MM DD" [(ngModel)]="searchObj.to"></ion-datetime>
                  <!--<ion-input formControlName="to" type="text" placeholder="End day"></ion-input>-->
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-grid>
          <ion-list no-padding>
            <button no-padding ion-item (click)="openPageParams('Affiliate')">
              <ion-label padding-left>
                Affiliate
              </ion-label>
              <div item-content class="item-content">
                {{ getAffiliateValue() }}
                <ion-icon md="ios-arrow-forward" color="light"></ion-icon>
              </div>
            </button>
            <button no-padding ion-item (click)="openPageParams('Transaction type')">
              <ion-label padding-left>
                Transaction Type
              </ion-label>
              <div item-content class="item-content">
                {{ getTypesValue(searchObj.transaction_type) }}
                <ion-icon md="ios-arrow-forward" color="light"></ion-icon>
              </div>
            </button>
          </ion-list>
          <ion-grid>
            <ion-row>
              <ion-list-header no-margin>
                Payment Method
              </ion-list-header>
            </ion-row>
            <ion-row>
              <ion-col *ngFor="let payment of globalTypesFromServer.pay_method | keys">
                <button #butPayment ion-button block [class.selected]="setSelectedClass(payments, payment.key)" (click)="toggleVal('payments', payment.key, butPayment)">
                  {{payment.value}}
                </button>
              </ion-col>
            </ion-row>
          </ion-grid>

          <ion-grid>
            <ion-row>
              <ion-list-header no-margin>
                Currency
              </ion-list-header>
            </ion-row>
            <ion-row padding-left padding-right>
              <ion-col *ngFor="let currency of currenciesFromServer">
                <button #butCurrency ion-button block [class.selected]="setSelectedClass(currencies, currency)" (click)="toggleVal('currencies', currency, butCurrency)">
                  {{ currency }}
                </button>
              </ion-col>
            </ion-row>
          </ion-grid>

          <ion-list>
            <ion-item-divider></ion-item-divider>
            <button ion-item (click)="openPageParams('Billing type')">
              <ion-label>
                Billing Type
              </ion-label>
              <div item-content class="item-content">
                {{ getTypesValue(searchObj.billing_type) }}
                <ion-icon md="ios-arrow-forward" color="light"></ion-icon>
              </div>
            </button>
          </ion-list>
        </ion-list>

    </ion-list>

  </section>

</ion-content>

<ion-footer>
  <button large text-capitalize ion-button full color="secondary" no-margin (click)="submit()">Search</button>
</ion-footer>
<section class="bottom-logo">
  <img src="assets/img/logo-long.png">
</section>
